<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Plaster</title>
    
    <meta name="description" content="Simple Mongoose-inspired schema based Javascript object modelling" />
    
    
    
    <meta property="og:title" content=""/>
    <meta property="og:type" content="website"/>
    <meta property="og:image" content=""/>
    
    <meta property="og:url" content=""/>
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <script src="scripts/jquery.min.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/bootstrap.min.css">
    <link type="text/css" rel="stylesheet" href="styles/jaguar.css">
    
    
    <script>
    var config = {"monospaceLinks":true,"cleverLinks":true,"default":{"outputSourceFiles":true},"applicationName":"Plaster","disqus":"","googleAnalytics":"","openGraph":{"title":"","type":"website","image":"","site_name":"","url":""},"meta":{"title":"Plaster","description":"Simple Mongoose-inspired schema based Javascript object modelling","keyword":""},"linenums":true};
    </script>
    

    
</head>
<body>
<div id="wrap" class="clearfix">
    
<div class="navigation">
    <h3 class="applicationName"><a href="index.html">Plaster</a></h3>

    <div class="search">
        <input id="search" type="text" class="form-control input-sm" placeholder="Search Documentations">
    </div>
    <ul class="list">

    
        <li class="item" data-name="Model">
            <span class="title">
                <a href="Model.html">Model</a>
                
            </span>
            <ul class="members itemMembers">
            
            <span class="subtitle">Members</span>
            
                <li data-name="Model#modelName"><a href="Model.html#modelName">modelName</a></li>
            
                <li data-name="Model#schema"><a href="Model.html#schema">schema</a></li>
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li data-name="Model#clear"><a href="Model.html#clear">clear</a></li>
            
                <li data-name="Model#clearErrors"><a href="Model.html#clearErrors">clearErrors</a></li>
            
                <li data-name="Model#getErrors"><a href="Model.html#getErrors">getErrors</a></li>
            
                <li data-name="Model#hasErrors"><a href="Model.html#hasErrors">hasErrors</a></li>
            
                <li data-name="Model#inspect"><a href="Model.html#inspect">inspect</a></li>
            
                <li data-name="Model#set"><a href="Model.html#set">set</a></li>
            
                <li data-name="Model#toJSON"><a href="Model.html#toJSON">toJSON</a></li>
            
                <li data-name="Model#toObject"><a href="Model.html#toObject">toObject</a></li>
            
                <li data-name="Model#toString"><a href="Model.html#toString">toString</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="ModelArray">
            <span class="title">
                <a href="ModelArray.html">ModelArray</a>
                
            </span>
            <ul class="members itemMembers">
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="ModelInstance">
            <span class="title">
                <a href="ModelInstance.html">ModelInstance</a>
                
            </span>
            <ul class="members itemMembers">
            
            <span class="subtitle">Members</span>
            
                <li data-name="ModelInstance.modelName"><a href="ModelInstance.html#.modelName">modelName</a></li>
            
                <li data-name="ModelInstance.schema"><a href="ModelInstance.html#.schema">schema</a></li>
            
                <li data-name="ModelInstance#modelName"><a href="ModelInstance.html#modelName">modelName</a></li>
            
                <li data-name="ModelInstance#schema"><a href="ModelInstance.html#schema">schema</a></li>
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li data-name="ModelInstance#clear"><a href="ModelInstance.html#clear">clear</a></li>
            
                <li data-name="ModelInstance#clearErrors"><a href="ModelInstance.html#clearErrors">clearErrors</a></li>
            
                <li data-name="ModelInstance#getErrors"><a href="ModelInstance.html#getErrors">getErrors</a></li>
            
                <li data-name="ModelInstance#hasErrors"><a href="ModelInstance.html#hasErrors">hasErrors</a></li>
            
                <li data-name="ModelInstance#inspect"><a href="ModelInstance.html#inspect">inspect</a></li>
            
                <li data-name="ModelInstance#set"><a href="ModelInstance.html#set">set</a></li>
            
                <li data-name="ModelInstance#toJSON"><a href="ModelInstance.html#toJSON">toJSON</a></li>
            
                <li data-name="ModelInstance#toObject"><a href="ModelInstance.html#toObject">toObject</a></li>
            
                <li data-name="ModelInstance#toString"><a href="ModelInstance.html#toString">toString</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="Plaster">
            <span class="title">
                <a href="Plaster.html">Plaster</a>
                
            </span>
            <ul class="members itemMembers">
            
            <span class="subtitle">Members</span>
            
                <li data-name="Plaster#Model"><a href="Plaster.html#Model">Model</a></li>
            
                <li data-name="Plaster#ModelArray"><a href="Plaster.html#ModelArray">ModelArray</a></li>
            
                <li data-name="Plaster#Plaster"><a href="Plaster.html#Plaster">Plaster</a></li>
            
                <li data-name="Plaster#Schema"><a href="Plaster.html#Schema">Schema</a></li>
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li data-name="Plaster#get"><a href="Plaster.html#get">get</a></li>
            
                <li data-name="Plaster#getModel"><a href="Plaster.html#getModel">getModel</a></li>
            
                <li data-name="Plaster#model"><a href="Plaster.html#model">model</a></li>
            
                <li data-name="Plaster#modelNames"><a href="Plaster.html#modelNames">modelNames</a></li>
            
                <li data-name="Plaster#schema"><a href="Plaster.html#schema">schema</a></li>
            
                <li data-name="Plaster#set"><a href="Plaster.html#set">set</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="Schema">
            <span class="title">
                <a href="Schema.html">Schema</a>
                
            </span>
            <ul class="members itemMembers">
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li data-name="Schema#add"><a href="Schema.html#add">add</a></li>
            
                <li data-name="Schema#extend"><a href="Schema.html#extend">extend</a></li>
            
                <li data-name="Schema#get"><a href="Schema.html#get">get</a></li>
            
                <li data-name="Schema#method"><a href="Schema.html#method">method</a></li>
            
                <li data-name="Schema#post"><a href="Schema.html#post">post</a></li>
            
                <li data-name="Schema#pre"><a href="Schema.html#pre">pre</a></li>
            
                <li data-name="Schema#queue"><a href="Schema.html#queue">queue</a></li>
            
                <li data-name="Schema#set"><a href="Schema.html#set">set</a></li>
            
                <li data-name="Schema#static"><a href="Schema.html#static">static</a></li>
            
                <li data-name="Schema#virtual"><a href="Schema.html#virtual">virtual</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
    </ul>
</div>
    <div class="main">
        <h1 class="page-title" data-filename="index.js.html">Source: index.js</h1>
        


    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>if (!global._babelPolyfill) {
  // This should be replaced with runtime transformer when this bug is fixed:
  // https://phabricator.babeljs.io/T2877
  require('babel-polyfill');
}

const _ = require('lodash');

// Without the --harmony and --harmony_proxies flags, options strict: false and dotNotation: true will fail with exception
if (typeof(Proxy) !== 'undefined') {
  // Workaround for https://github.com/tvcutsem/harmony-reflect/issues/66
  const warn = console.warn;
  console.warn = function (message) {
    if (message !== 'getOwnPropertyNames trap is deprecated. Use ownKeys instead') {
      warn.apply(console, arguments);
    }
  };
  require('harmony-reflect');
}

import { Schema } from './schema'
import { Model } from './model'
import { ModelArray } from './modelarray'
import { compile } from './compile'

/**
 * Main Plaster class. Use this class to set default options and create schemas and models.
 * @class
 *
 * @example
 * var plaster = require('plaster');
 *
 * var schema = plaster.schema({ name: String });
 * var Cat = plaster.model('Cat', schema);
 * var kitty = new Cat({ name: 'Zildjian' });
 *
 */
class Plaster {
  /**
   * By default we export an instance of Plaster object.
   * Clients can create a new instances using the constructor.
   *
   * @example
   * var plaster = require('plaster');
   * var p2 = new plaster.Plaster();
   *
   * @param {Object} options default schema options
   * @param {Boolean} options.strict - By default (&lt;code>true&lt;/code>), allow only values in the schema to be set.
   *                                 When this is &lt;code>false&lt;/code>, setting new fields will dynamically add the field
   *                                 to the schema as type "any".
   * @param {Boolean} options.dotNotation - Allow fields to be set via dotNotation. Default: &lt;code>true&lt;/code>.
   *                                      &lt;code>obj['user.name'] = 'Joe'; -> obj: { user: 'Joe' }&lt;/code>
   *
   */
  constructor(options = {}) {
    this.models = {};
    this.options = options;

    /**
     * Expose the Schema class
     * @member {Schema}
     *
     * @example
     * var schema = new plaster.Schema({ name: String});
     */
    this.Schema = Schema;

    /**
     * Expose the Model class
     * @member {Model}
     *
     * @example
     * var schema = plaster.schema({ name: String });
     * var Cat = plaster.model('Cat', schema);
     * var kitty = new Cat({ name: 'Zildjian' });
     * console.log(kitty insanceof plaster.Model); // true
     */
    this.Model = Model;

    /**
     * Expose the ModelArray class
     * @member {ModelArray}
     */
    this.ModelArray = ModelArray;

    /**
     * Expose Plaster constructor so clients can create new instances.
     * @member {Plaster}
     */
    this.Plaster = Plaster;
  }

  /**
   * Creates a schema. Prefer to use this over Schema constructor as this will pass along Plaster config settings.
   *
   * @api public
   * @param {Object} descriptor the schema descriptor
   * @param {Object} options Schema options
   * @return {Object} created Schema instance
   */
  schema(descriptor, options) {
    let opts = _.defaults(options || {}, this.options);
    return new Schema(descriptor, opts);
  }

  /**
   * Creates a model from a schema.
   *
   * @api public
   * @param {String} name name of the model.
   * @param {Schema} schema instance
   * @param {Object} options - options
   * @param {Boolean} options.freeze - to freeze model. See &lt;code>Object.freeze&lt;/code>. Default: &lt;code>true&lt;/code>
   */
  model(name, schema, options = {}) {
    if (!(schema instanceof Schema))
      schema = new Schema(schema, options || this.options);

    if (this.models[name])
      return this.models[name];

    const M = compile(schema, options, name);
    this.models[name] = M;
    return M;
  }

  /**
   * Sets Plaster config options
   *
   * @api public
   * @param key {String} the option key
   * @param value {*} option value
   */
  set(key, value) {
    if (arguments.length === 1) {
      return this.options[key];
    }

    this.options[key] = value;
    return this;
  }

  /**
   * Get option.
   * @type {Function|*}
   * @return {*} Option value
   */
  get() {
    this.set.call(this, arguments)
  }

  /**
   * Returns the model given the name.
   * @param name
   * @returns {*}
   */
  getModel(name) {
    return this.models[name];
  }

  /**
   * Returns an array of model names created on this instance of Plaster.
   *
   * @api public
   * @return {Array} Array of model names registered.
   */
  modelNames() {
    return Object.keys(this.models);
  }
}

module.exports = new Plaster();</code></pre>
        </article>
    </section>






        

        <footer>
            Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.0</a> on Thu Feb 11 2016 09:05:52 GMT-0400 (AST)
        </footer>
    </div>
</div>
<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
<script src="scripts/main.js"></script>
</body>
</html>
